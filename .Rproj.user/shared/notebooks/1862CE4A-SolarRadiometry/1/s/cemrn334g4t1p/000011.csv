"0","library(ggplot2)"
"0",""
"0","blanksky_data <- c(5.8, 5.6, 5.1, 5.0, 5.3, 5.1, 5.3, 5.1, 5.0, 5.4, 5.3, 5.2, 5.9, 5.3, 6.3, 5.5, 5.7, 5.5, 5.6, 5.3, 5.5, 5.1, 5.2, 5.0, 5.7, 5.1, 5.0, 5.2, 5.4, 5.5, 5.2, 5.3, 5.2, 5.1, 5.4, 5.5, 5.7, 5.2, 5.4, 5.9, 5.2, 6.0, 5.2, 5.3, 5.4, 6.0, 6.5, 5.5, 5.4, 5.5)"
"0","blanksky_powervals <- data.frame(value = blanksky_data)"
"0","filtered_data <- subset(blanksky_powervals, value <= 5.6)"
"0",""
"0","# Calculating mean and sd for the original data"
"0","blanksky_mean <- mean(blanksky_data)"
"0","blanksky_sd <- sd(blanksky_data)"
"0",""
"0","# Calculating mean and sd for the filtered data"
"0","filtered_mean <- mean(filtered_data$value)"
"0","filtered_sd <- sd(filtered_data$value)"
"0",""
"0","# Shapiro-Wilk test result"
"0","shapiro_result <- shapiro.test(blanksky_data)"
"0",""
"0","# Plot with corrected code"
"0","ggplot(data = blanksky_powervals, aes(x = value)) +"
"0","  geom_histogram(aes(y = ..density..), binwidth = 0.1, colour = ""black"", fill = ""white"") +"
"0","  stat_function(fun = dnorm, args = list(mean = blanksky_mean, sd = blanksky_sd), aes(colour = ""Normal Distribution Fit""), size = 1) +"
"0","  stat_function(fun = dnorm, args = list(mean = filtered_mean, sd = filtered_sd), aes(colour = ""Hypothetical Curve""), size = 1) +"
"0","  scale_colour_manual(values = c(""Normal Distribution Fit"" = ""red"", ""Hypothetical Curve"" = ""blue""),"
"0","                      breaks = c(""Normal Distribution Fit"", ""Hypothetical Curve"")) +"
"0","  scale_x_continuous(breaks = seq(5.0, 6.6, by = 0.2)) +"
"0","  labs("
"0","    title = ""Figure 3 - Distribution of Blank Sky Power Readings"","
"0","    x = ""Power Reading on Accutrac"","
"0","    y = ""Density"","
"0","    caption = sprintf(""Mean: %.2f | SD: %.2f | Shapiro-Wilk W: %.4f, p-value: %.4f"", "
"0","                      blanksky_mean, blanksky_sd, shapiro_result$statistic, shapiro_result$p.value)"
"0","  ) +"
"0","  theme("
"0","    legend.position = ""bottom"","
"0","    plot.caption = element_text(hjust = 0.5)"
"0","  ) +"
"0","  guides(colour = guide_legend(title = ""Distribution"", order = 1, reverse = FALSE))"
