"0","set.seed(123) # For reproducibility"
"0",""
"0","n <- 10000 # Sample size for the analysis"
"0",""
"0","# Generating baseline samples"
"0","R_samples <- rnorm(n, 290, 0)"
"0","L_samples <- rnorm(n, 77, 0)"
"0","D_samples <- rnorm(n, 0.4572, 0.015)"
"0","M_samples <- rnorm(n, 5.42, 0.33)"
"0","v_samples <- rnorm(n, 9.32, 0.33)"
"0","a_samples <- rnorm(n, 29.71, 0.08)"
"0","b_samples <- rnorm(n, 39.35, 0.19)"
"0",""
"0","# Define the functions based on the given formulas"
"0","calculate_Q <- function(D) {"
"0","  asin(1.22 * (0.025 / D))"
"0","}"
"0",""
"0","calculate_x <- function(M, a, b) {"
"0","  10 ^ ((M - a) / b)"
"0","}"
"0",""
"0","calculate_y <- function(v, a, b) {"
"0","  10 ^ ((v - a) / b)"
"0","}"
"0",""
"0","calculate_N <- function(L, R, x) {"
"0","  (L - R * x) / (x - 1)"
"0","}"
"0",""
"0","calculate_Z <- function(R, y, N) {"
"0","  R * y + N * y - N"
"0","}"
"0",""
"0","calculate_A <- function(Q) {"
"0","  pi * (Q^2)"
"0","}"
"0",""
"0","calculate_F <- function(Z, A) {"
"0","  (Z * A - 3 * (A - (6.79 * 10^(-5)))) / (6.79 * 10^(-5))"
"0","}"
"0",""
"0","# Calculate baseline F"
"0","baseline_Q <- calculate_Q(D_samples)"
"0","baseline_x <- calculate_x(M_samples, a_samples, b_samples)"
"0","baseline_y <- calculate_y(v_samples, a_samples, b_samples)"
"0","baseline_N <- calculate_N(L_samples, R_samples, baseline_x)"
"0","baseline_Z <- calculate_Z(R_samples, baseline_y, baseline_N)"
"0","baseline_A <- calculate_A(baseline_Q)"
"0","baseline_F <- calculate_F(baseline_Z, baseline_A)"
"0",""
"0","# Function to perturb a variable and calculate the change in F"
"0","perturb_and_calculate_change <- function(variable_name, perturbation) {"
"0","  if (variable_name == ""D"") {"
"0","    new_Q <- calculate_Q(D_samples + perturbation)"
"0","    new_A <- calculate_A(new_Q)"
"0","    new_F <- calculate_F(baseline_Z, new_A)"
"0","  } else if (variable_name == ""M"" || variable_name == ""a"" || variable_name == ""b"") {"
"0","    new_x <- calculate_x(M_samples + ifelse(variable_name == ""M"", perturbation, 0), "
"0","                         a_samples + ifelse(variable_name == ""a"", perturbation, 0), "
"0","                         b_samples + ifelse(variable_name == ""b"", perturbation, 0))"
"0","    new_N <- calculate_N(L_samples, R_samples, new_x)"
"0","    new_Z <- calculate_Z(R_samples, baseline_y, new_N)"
"0","    new_F <- calculate_F(new_Z, baseline_A)"
"0","  } else if (variable_name == ""v"") {"
"0","    new_y <- calculate_y(v_samples + perturbation, a_samples, b_samples)"
"0","    new_Z <- calculate_Z(R_samples, new_y, baseline_N)"
"0","    new_F <- calculate_F(new_Z, baseline_A)"
"0","  } else if (variable_name == ""R"" || variable_name == ""L"") {"
"0","    new_N <- calculate_N(L_samples + ifelse(variable_name == ""L"", perturbation, 0), "
"0","                         R_samples + ifelse(variable_name == ""R"", perturbation, 0), "
"0","                         baseline_x)"
"0","    new_Z <- calculate_Z(R_samples + ifelse(variable_name == ""R"", perturbation, 0), "
"0","                         baseline_y, new_N)"
"0","    new_F <- calculate_F(new_Z, baseline_A)"
"0","  }"
"0","  "
"0","  return(mean(abs(new_F - baseline_F) / baseline_F))"
"0","}"
"0",""
"0","# Sensitivity analysis for each variable"
"0","variables <- c(""D"", ""M"", ""v"", ""a"", ""b"", ""R"", ""L"")"
"0","sensitivities <- sapply(variables, function(var) {"
"0","  perturbation <- if (var == ""D"") 0.01 * mean(D_samples) else 0.01"
"0","  perturb_and_calculate_change(var, perturbation)"
"0","})"
"0",""
"0","names(sensitivities) <- variables"
"0","sensitivities"
"1","           D "
"1","           M "
"1","           v "
"1","           a "
"1","           b "
"1","           R "
"1","           L "
"1","
"
"1","1.975033e-02 "
"1","3.993700e-04 "
"1","5.456096e-04 "
"1","3.989876e-04 "
"1","2.462712e-04 "
"1","8.905639e-06 "
"1","1.005742e-04 "
"1","
"
